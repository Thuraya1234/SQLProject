/*==============================================================*/
/* Create Tables                                              */
/*==============================================================*/
CREATE TABLE COLLEGE(
Cl_Code CHAR(3) CONSTRAINT 
code_coll_pk PRIMARY KEY, 
Cl_Name CHAR(40) NOT NULL,
Cl_Dean CHAR(30));


CREATE TABLE DEPARTMENT(
Dp_Code CHAR(4) PRIMARY KEY,
Dp_Name CHAR(40) NOT NULL, 
Dp_HoD CHAR(30),
Dp_Col CHAR(3),
CONSTRAINT depart_coll_fk FOREIGN KEY(Dp_Col) 
REFERENCES COLLEGE(Cl_Code));


CREATE TABLE BOOK(
Bk_ID NUMERIC(6) PRIMARY KEY CHECK (Bk_ID>0),
Bk_Title CHAR(50) NOT NULL,
Bk_Edition NUMERIC(2), 
Bk_#ofPages NUMERIC(4) CHECK (Bk_#ofPages>0),
Bk_TotalCopies NUMERIC(5),
Bk_RemCopies NUMERIC(5));


CREATE TABLE BOOKTOPIC(
Tp_BkID NUMERIC(6),
Tp_Desc CHAR(30) NOT NULL,
CONSTRAINT bookt_book_fk FOREIGN KEY(Tp_BkID) 
REFERENCES BOOK(Bk_ID));


CREATE TABLE BORROWER(
Br_ID NUMERIC(6) PRIMARY KEY CHECK(Br_ID>0),
Br_Name CHAR(30) NOT NULL,
Br_Dept CHAR(4),
Br_Mobile CHAR(8) CHECK(Br_Mobile>=90000000),
Br_City CHAR(20),
Br_House# CHAR(4), 
Br_Type CHAR(1) CHECK(Br_Type = 'S' OR Br_Type = 'E')
CONSTRAINT borrow_dep_fk FOREIGN KEY(Br_Dept) 
REFERENCES DEPARTMENT(Dp_Code));


CREATE TABLE EMPLOYEE(
Em_ID NUMERIC(6) PRIMARY KEY CHECK(Em_ID>0),
Em_Office# CHAR(4) NOT NULL,
Em_Ext# NUMERIC(4) CHECK(Em_Ext#>0));


CREATE TABLE STUDENT(
St_ID NUMERIC(6) PRIMARY KEY CHECK(St_ID>0),
St_Major CHAR(30),
St_Cohort NUMERIC(4) NOT NULL);


CREATE TABLE COURSE(
Cr_Code CHAR(8) CONSTRAINT col_course_pk PRIMARY KEY, 
Cr_Title CHAR(40) NOT NULL ,
Cr_CH NUMERIC(2) CHECK(Cr_CH>0),
Cr_#ofSec NUMERIC(2) CHECK(Cr_#ofSec>0),
Cr_Dept CHAR(4),
CONSTRAINT cours_dep_fk FOREIGN KEY(Cr_Dept)
REFERENCES DEPARTMENT(Dp_Code));


CREATE TABLE LINK(
Li_CrCode CHAR(8),
Li_BkID NUMERIC(6),
Li_usage CHAR(1) CHECK (Li_usage = 'T' OR Li_usage = 'R'),
CONSTRAINT link_cours_fk FOREIGN KEY(Li_CrCode) REFERENCES COURSE(Cr_Code) ,
CONSTRAINT link_book_fk FOREIGN KEY(Li_BkID) REFERENCES BOOK(Bk_ID));


CREATE TABLE REGISTRATION(
Re_BrID NUMERIC(6),
Re_CrCode CHAR(8),
Re_Semester CHAR(6) NOT NULL,
CONSTRAINT reg_borrow_fk FOREIGN KEY(Re_BrID) REFERENCES BORROWER(Br_ID),
CONSTRAINT reg_cours_fk FOREIGN KEY(Re_CrCode) REFERENCES COURSE(Cr_Code));


CREATE TABLE ISSUING(
is_BrID NUMERIC(6)
CONSTRAINT issu_borrow_fk FOREIGN KEY REFERENCES BORROWER(Br_ID),
is_BkID NUMERIC(6)
CONSTRAINT issu_book_fk FOREIGN KEY REFERENCES BOOK(Bk_ID),
is_DateTaken DATE NOT NULL,
is_DateReturn DATE CHECK(is_DateReturn>is_DateTaken));

/*==============================================================*/
/* Insert Tables                                              */
/*==============================================================*/

INSERT INTO COLLEGE VALUES('COM', 'Economy', 'Prof. Fahim');
INSERT INTO COLLEGE VALUES('SCI', 'Science', 'Prof. Salma');
INSERT INTO COLLEGE VALUES('EDU', 'Education', 'Dr. Hamad');
INSERT INTO COLLEGE VALUES('ART', 'Arts', 'Dr. Abdullah');

INSERT INTO DEPARTMENT VALUES('INFS', 'Information Systems', 'COM', 'Dr. Kamla');
INSERT INTO DEPARTMENT VALUES('FINA', 'Finance', 'COM', 'Dr. Salim');
INSERT INTO DEPARTMENT VALUES('COMP', 'Computer Science', 'SCI', 'Dr. Zuhoor');
INSERT INTO DEPARTMENT VALUES('BIOL', 'Biology', 'SCI', 'Dr. Othman');
INSERT INTO DEPARTMENT VALUES('HIST', 'History', 'EDU', 'Dr. Said');

INSERT INTO BOOK VALUES(1001, 'Database1', 2, 450, 150, 65);
INSERT INTO BOOK VALUES(1002, 'Database2', 3, 300, 100, 100);
INSERT INTO BOOK VALUES(2001, 'Intro. to Finanace', 1, 600, 75, 40);
INSERT INTO BOOK VALUES(3001, 'Basic Op Mgmt', 1, 320, 100, 77);
INSERT INTO BOOK VALUES(3002, 'Chemistry Book', 2, 500, 100, 80);
INSERT INTO BOOK VALUES(4001, 'Biology', 1, 345, 100, 100);
INSERT INTO BOOK VALUES(3003, 'Management I', 2, 560, 44, 34);
INSERT INTO BOOK VALUES(1003, 'Java Prog.', 3, 555, 50, 50);


INSERT INTO BOOKTOPIC VALUES(1001, 'Basic DB Skills');
INSERT INTO BOOKTOPIC VALUES(1001, 'ERD');
INSERT INTO BOOKTOPIC VALUES(1001, 'EERD');
INSERT INTO BOOKTOPIC VALUES(1002, 'SQL');
INSERT INTO BOOKTOPIC VALUES(1002, 'Pl/SQL');
INSERT INTO BOOKTOPIC VALUES(3001, 'Management Skills');


INSERT INTO BORROWER VALUES(92120, 'Ali', 'INFS', '99221133', 'Seeb', '231', 'S');
INSERT INTO BORROWER VALUES(10021, 'Said', 'INFS', '91212129', 'Seeb', '100', 'S');
INSERT INTO BORROWER VALUES(10023, 'Muna', 'FINA', '', 'Barka', '12', 'S');
INSERT INTO BORROWER VALUES(3000, 'Mohammed', 'COMP', '90000009', 'Seeb', '777', 'E');
INSERT INTO BORROWER VALUES(4000, 'Nasser', 'INFS', '99100199', 'Sur', '11', 'E');

INSERT INTO EMPLOYEE VALUES(3000, '12', 2221);
INSERT INTO EMPLOYEE VALUES(4000, '15', 1401);


INSERT INTO STUDENT VALUES(92120, 'INFS', 2012);
INSERT INTO STUDENT VALUES(10021, 'INFS', 2015);
INSERT INTO STUDENT VALUES(10023, 'FINA', 2015);


INSERT INTO COURSE VALUES('COMP4201', 'Database1', 3, 1, 'COMP');
INSERT INTO COURSE VALUES('COMP4202', 'Database2', 3, 2, 'COMP');
INSERT INTO COURSE VALUES('BIOL1000', 'Intro. To Biology', 4, 5, 'BIOL');
INSERT INTO COURSE VALUES('CHEM2000', 'Advanced Chemistry', 2, 2, 'CHEM');


INSERT INTO LINK VALUES('COMP4201', 1001, 'T');
INSERT INTO LINK VALUES('COMP4201', 1002, 'R');
INSERT INTO LINK VALUES('COMP4202', 1002, 'T');
INSERT INTO LINK VALUES('BIOL1000', 4001, 'T');
INSERT INTO LINK VALUES('CHEM2000', 3002, 'R');


INSERT INTO REGISTRATION VALUES(92120, 'COMP4201', 'FL2015');
INSERT INTO REGISTRATION VALUES(10021, 'COMP4202', 'FL2015');
INSERT INTO REGISTRATION VALUES(92120, 'BIOL1000', 'FL2015');
INSERT INTO REGISTRATION VALUES(92120, 'COMP4202', 'FL2016');
INSERT INTO REGISTRATION VALUES(10021, 'CHEM2000', 'FL2016');


INSERT INTO ISSUING VALUES(92120, 1001,'01-Sep-2015', '30-Oct-2015');
INSERT INTO ISSUING VALUES(10021, 1002,'30-Oct-2016', NULL);
INSERT INTO ISSUING VALUES(92120, 1002,'21-Feb-2015 ', '01-Jan-2016');
INSERT INTO ISSUING VALUES(92120, 3002,'30-Mar-2016', NULL);
INSERT INTO ISSUING VALUES(10021, 3002,'01-Dec-2014', NULL);










